!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.InteractionHandler=n():t.InteractionHandler=n()}(this,(()=>(()=>{"use strict";var t={d:(n,e)=>{for(var i in e)t.o(e,i)&&!t.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:e[i]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n)},n={};function e(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.d(n,{default:()=>i});const i=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.olMap=n,this._interactions={},this._mapInteractions={},this._activeInteraction=null,this._blockMapInteraction=!1,this._onInteractionStart=null,this._onInteractionEnd=null,this._onClear=null,this._onUpdate=null}var n,i;return n=t,(i=[{key:"active",get:function(){return!!this._activeInteraction}},{key:"isActive",value:function(){return this.active}},{key:"activeInteraction",get:function(){return this._activeInteraction}},{key:"get",value:function(t){return t in this._interactions&&this._interactions[t]||null}},{key:"onInteractionStart",get:function(){return this._onInteractionStart},set:function(t){this._onInteractionStart=t}},{key:"onInteractionEnd",get:function(){return this._onInteractionEnd},set:function(t){this._onInteractionEnd=t}},{key:"onClear",get:function(){return this._onClear},set:function(t){this._onClear=t}},{key:"onUpdate",get:function(){return this._onUpdate},set:function(t){this._onUpdate=t}},{key:"addInteraction",value:function(t,n){var e=null;return t in this._interactions&&(e=this._interactions[t]),this._interactions[t]=n,e}},{key:"removeInteraction",value:function(t){if(!(t in this._interactions))return null;this._activeInteraction&&this._activeInteraction===t?this.interrupt(null,this.removeInteraction.bind(this,t)):delete this._interactions[t]}},{key:"startInteraction",value:function(t,n){var e=!1;if(!this._activeInteraction||(e=t===this._activeInteraction)){if(this._onInteractionStart){var i;try{i=this._onInteractionStart(n,t)}catch(t){return void console.error(t)}if(!1===i)return void(e||this.interrupt(n))}if(t in this._interactions){this._activeInteraction=t;try{(!e||!0===this._interactions[this._activeInteraction].restart||"function"==typeof this._interactions[this._activeInteraction].restart&&!1!==this._interactions[this._activeInteraction].restart(n))&&this._interactions[this._activeInteraction].start(n)}catch(t){return console.error(t),void(this._activeInteraction=null)}if(!this._activeInteraction)return;!e&&this._interactions[this._activeInteraction].olInteraction&&this.olMap.addInteraction(this._interactions[this._activeInteraction].olInteraction)}}else this.interrupt(n,this.startInteraction.bind(this,t,n),this._cancelStartInteraction.bind(this,t))}},{key:"endInteraction",value:function(t,n,e,i){if(this._activeInteraction){var a=null,r=null;try{r=this._interactions[this._activeInteraction].end(t,n)}catch(t){a=t.message,console.error(t)}try{this._interactions[this._activeInteraction].olInteraction&&this.olMap.removeInteraction(this._interactions[this._activeInteraction].olInteraction)}catch(t){a=t.message,console.error(t)}try{e||this.clearInteraction()}catch(t){a=t.message,console.error(t)}try{this._onInteractionEnd&&this._onInteractionEnd(t,this._activeInteraction,n)}catch(t){a=t.message,console.error(t)}var o=this._activeInteraction;this._activeInteraction=null,this._blockMapInteraction=!1;try{!i&&this._onUpdate&&this._onUpdate(o,r,a)}catch(t){a=t.message,console.error(t)}return a}}},{key:"clearInteraction",value:function(){this._onClear&&this._onClear(),this._interactions[this._activeInteraction].clear&&this._interactions[this._activeInteraction].clear()}},{key:"interrupt",value:function(t,n,e){var i=this;if(this._activeInteraction&&this._interactions[this._activeInteraction].checkInterrupt){var a=this._interactions[this._activeInteraction].saveOnInterrupt;try{this._interactions[this._activeInteraction].checkInterrupt((function(){i.endInteraction(t,a),n&&n()}),e||function(){})}catch(t){console.error(t)}}else this.endInteraction(t),n&&n()}},{key:"_cancelStartInteraction",value:function(t){t&&t in this._interactions&&this._interactions[t].cancelStart&&this._interactions[t].cancelStart()}},{key:"addMapListener",value:function(t){var n=this;this.removeMapListener(t),this._mapInteractions[t]=function(e){!n._blockMapInteraction&&n._activeInteraction&&n._interactions[n._activeInteraction].map&&t in n._interactions[n._activeInteraction].map&&n._interactions[n._activeInteraction].map[t](e)},this.olMap.on(t,this._mapInteractions[t])}},{key:"removeMapListener",value:function(t){t in this._mapInteractions&&(this.olMap.un(t,this._mapInteractions[t]),delete this._mapInteractions[t])}},{key:"removeAllMapListeners",value:function(){for(var t in this._mapInteractions)this.olMap.un(t,this._mapInteractions[t]),delete this._mapInteractions[t]}},{key:"disableMapInteractions",value:function(){this._blockMapInteraction=!0}},{key:"enableMapInteractions",value:function(){this._blockMapInteraction=!1}},{key:"bindUiElements",value:function(t,n){var e=this;(n=n||{}).value=n.value||n.valueFunction||function(){return this.value},n.event=n.event||"click","undefined"!=typeof jQuery&&t instanceof jQuery?t=t.get():"function"===t[Symbol.iterator]||t instanceof Array||t instanceof NodeList||(t=[t]);var i,a=this;i=n.interruptOnly?function(t){n.always&&n.always(),a._uiInterruptorListener(n.onInterrupt,t)}:function(t){n.always&&n.always(),e._uiListener(n.value,t)},t.forEach((function(t){return t.addEventListener(n.event,i)}))}},{key:"_uiListener",value:function(t,n,e){var i="function"==typeof n?n.call(t,e):n;this._activeInteraction&&i===this._activeInteraction?this.startInteraction(i,e):this.interrupt(e,this.startInteraction.bind(this,i,e),this._cancelStartInteraction.bind(this,i))}},{key:"_uiInterruptorListener",value:function(t,n,e){var i=this._activeInteraction&&this._interactions[this._activeInteraction].checkInterrupt;i&&(e.preventDefault(),e.stopPropagation()),this.interrupt(e,(function(){n&&n(),i&&t.click()}))}}])&&e(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();return n.default})()));